<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Retro DV</title>
    <style>
        :root { --ios-red: #ff3b30; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; font-family: -apple-system, system-ui; overflow: hidden; color: white; }
        
        /* Ëû¢ÂπïÈ†êË¶Ω */
        #viewport { position: relative; width: 100%; height: 100%; overflow: hidden; display: flex; align-items: center; }
        video { width: 100%; height: 100%; object-fit: cover; transition: transform 0.1s ease-out; }

        /* DV Âæ©Âè§ÊøæÈè° */
        .overlay { position: absolute; inset: 0; pointer-events: none; z-index: 2;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.05) 50%); background-size: 100% 4px; opacity: 0.6; }

        /* UI ÂÖÉÁ¥† */
        .rec-dot { position: absolute; top: 50px; left: 20px; color: var(--ios-red); font-weight: bold; display: none; z-index: 3; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        .timestamp { position: absolute; bottom: 140px; left: 20px; font-family: 'Courier New', monospace; color: #f7d51d; text-shadow: 2px 2px #000; z-index: 3; line-height: 1.2; }

        /* Zoom ÊéßÂà∂ */
        .zoom-wrap { position: absolute; right: 20px; top: 40%; transform: translateY(-50%); display: flex; flex-direction: column; align-items: center; z-index: 10; }
        .zoom-slider { appearance: none; -webkit-appearance: none; width: 180px; height: 4px; background: rgba(255,255,255,0.3); border-radius: 2px; transform: rotate(-90deg); margin: 80px 0; }
        .zoom-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 28px; height: 28px; border-radius: 50%; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }

        /* Â∫ïÈÉ®ÊéßÂà∂Ê¨Ñ */
        .controls { position: absolute; bottom: 0; width: 100%; height: 120px; background: rgba(0,0,0,0.6); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); display: flex; align-items: center; justify-content: space-around; z-index: 5; padding-bottom: env(safe-area-inset-bottom); }
        .btn-side { width: 45px; height: 45px; border-radius: 50%; background: rgba(255,255,255,0.1); border: none; color: white; font-size: 20px; }
        .record-trigger { width: 72px; height: 72px; border-radius: 50%; background: white; padding: 4px; border: none; }
        .record-inner { width: 100%; height: 100%; border-radius: 50%; background: var(--ios-red); transition: 0.3s; }
        .recording .record-inner { border-radius: 8px; transform: scale(0.7); }
    </style>
</head>
<body>

    <div id="viewport">
        <div class="rec-dot" id="rec-indicator">‚óè REC</div>
        <div class="overlay"></div>
        <div class="timestamp" id="ts"></div>
        
        <video id="v" autoplay playsinline muted></video>

        <div class="zoom-wrap">
            <span id="zoom-txt">1.0x</span>
            <input type="range" class="zoom-slider" id="z" min="1" max="4" step="0.1" value="1">
            <span>ZOOM</span>
        </div>

        <div class="controls">
            <button class="btn-side" onclick="switchCam()">üîÑ</button>
            <button class="record-trigger" onclick="toggleRec()">
                <div class="record-inner" id="btn-icon"></div>
            </button>
            <button class="btn-side" onclick="alert('ÈåÑÂΩ±ÊúÉËá™Âãï‰∏ãËºâÂà∞‰Ω†ÁöÑÁõ∏Á∞øÊàñÊ™îÊ°à‰∏≠')">‚ÑπÔ∏è</button>
        </div>
    </div>

    <script>
        const v = document.getElementById('v');
        const ts = document.getElementById('ts');
        const z = document.getElementById('z');
        const zTxt = document.getElementById('zoom-txt');
        let mode = "environment";
        let recorder, chunks = [], isRec = false;

        async function init() {
            const s = await navigator.mediaDevices.getUserMedia({ video: { facingMode: mode }, audio: true });
            v.srcObject = s;
            window.stream = s;
        }

        function switchCam() { mode = mode === "user" ? "environment" : "user"; init(); }

        z.oninput = () => {
            v.style.transform = `scale(${z.value})`;
            zTxt.innerText = `${parseFloat(z.value).toFixed(1)}x`;
        };

        function toggleRec() {
            if (!isRec) {
                chunks = [];
                recorder = new MediaRecorder(window.stream, { mimeType: 'video/mp4' });
                recorder.ondataavailable = e => chunks.push(e.data);
                recorder.onstop = () => {
                    const blob = new Blob(chunks, { type: 'video/mp4' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url; a.download = `DV_${Date.now()}.mp4`; a.click();
                };
                recorder.start();
                document.getElementById('rec-indicator').style.display = 'block';
                document.getElementById('btn-icon').parentElement.classList.add('recording');
            } else {
                recorder.stop();
                document.getElementById('rec-indicator').style.display = 'none';
                document.getElementById('btn-icon').parentElement.classList.remove('recording');
            }
            isRec = !isRec;
        }

        setInterval(() => {
            const d = new Date();
            const m = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
            ts.innerHTML = `${m[d.getMonth()]} ${String(d.getDate()).padStart(2,'0')} ${d.getFullYear()}<br>${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}:${String(d.getSeconds()).padStart(2,'0')}`;
        }, 1000);

        init();
    </script>
</body>
</html>